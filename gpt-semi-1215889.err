/usr/local/lib/python3.12/dist-packages/modelopt/torch/utils/import_utils.py:32: UserWarning: Failed to import megatron plugin due to: ImportError("cannot import name 'get_tensor_model_parallel_group_if_none' from 'megatron.core.utils' (/iopsstor/scratch/cscs/ooikonomou/Megatron-LM-new-attention/megatron/core/utils.py)"). You may ignore this warning if you do not need this plugin.
  warnings.warn(
/usr/local/lib/python3.12/dist-packages/modelopt/torch/speculative/plugins/megatron_eagle.py:68: UserWarning: Fail to import megatron.core.post_training! EAGLE feature will be disable!
  warnings.warn("Fail to import megatron.core.post_training! EAGLE feature will be disable!")
/usr/local/lib/python3.12/dist-packages/transformer_engine/pytorch/cpu_offload.py:708: DeprecationWarning: Offloading weights is deprecated. Using offload_weights=True does not have any effect.
  warnings.warn(
[rank0]: Traceback (most recent call last):
[rank0]:   File "/iopsstor/scratch/cscs/ooikonomou/Megatron-LM-new-attention/pretrain_gpt.py", line 323, in <module>
[rank0]:     pretrain(
[rank0]:   File "/iopsstor/scratch/cscs/ooikonomou/Megatron-LM-new-attention/megatron/training/training.py", line 422, in pretrain
[rank0]:     iteration, num_floating_point_operations_so_far = train(
[rank0]:                                                       ^^^^^^
[rank0]:   File "/iopsstor/scratch/cscs/ooikonomou/Megatron-LM-new-attention/megatron/training/training.py", line 1719, in train
[rank0]:     Path(args.exit_trigger).touch()
[rank0]:   File "/usr/lib/python3.12/pathlib.py", line 1305, in touch
[rank0]:     fd = os.open(self, flags, mode)
[rank0]:          ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: NotADirectoryError: [Errno 20] Not a directory: '/dev/null/exit'
srun: error: nid007251: task 0: Exited with exit code 1
srun: Terminating StepId=1215889.0
